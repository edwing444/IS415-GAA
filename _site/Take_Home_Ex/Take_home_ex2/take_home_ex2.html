<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="edwin tan">

<title>IS415-GAA - Take Home Exercise 2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercises">    
        <li>
    <a class="dropdown-item" href="../../Hands_On_Ex/Hands_On_Ex1/hands_on_ex1.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_On_Ex/Hands_On_Ex2/hands_on_ex2.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_On_Ex/Hands_On_Ex3/hands_on_ex3.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_On_Ex/Hands_On_Ex3/hands_on_ex3b.html">
 <span class="dropdown-text">Hands-on Exercise 3b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_On_Ex/Hands_On_Ex4/hands_on_ex4.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_On_Ex/Hands_On_Ex5/hands_on_ex5.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_On_Ex/Hands_On_Ex6/hands_on_ex6.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_On_Ex/Hands_On_Ex6/hands_on_ex6b.html">
 <span class="dropdown-text">Hands-on Exercise 6b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands_On_Ex/Hands_On_Ex6/hands_on_ex6b.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-Class Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercises">    
        <li>
    <a class="dropdown-item" href="../../In_Class_Excercise/In_Class_Ex1/In_Class_Ex1.html">
 <span class="dropdown-text">In-Class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_Class_Excercise/In_Class_Ex2/In_Class_Ex2.html">
 <span class="dropdown-text">In-Class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_Class_Excercise/In_Class_Ex3/In_Class_Ex3.html">
 <span class="dropdown-text">In-Class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_Class_Excercise/In_Class_Ex4/In_Class_Ex4.html">
 <span class="dropdown-text">In-Class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_Class_Excercise/In_Class_Ex5/In_Class_Ex5.html">
 <span class="dropdown-text">In-Class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In_Class_Excercise/In_Class_Ex6/In_Class_Ex6.html">
 <span class="dropdown-text">In-Class Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercises" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-Home Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercises">    
        <li>
    <a class="dropdown-item" href="../../Take_Home_Ex/Take_home_ex1/take_home_ex1.html">
 <span class="dropdown-text">Take-Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take_Home_Ex/Take_home_ex2/take_home_ex2.html">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">Background</a>
  <ul class="collapse">
  <li><a href="#geopolitical-context" id="toc-geopolitical-context" class="nav-link" data-scroll-target="#geopolitical-context">1. <strong>Geopolitical Context</strong></a></li>
  <li><a href="#transportation-infrastructure" id="toc-transportation-infrastructure" class="nav-link" data-scroll-target="#transportation-infrastructure">2. <strong>Transportation Infrastructure</strong></a></li>
  <li><a href="#prevalence-of-drug-use" id="toc-prevalence-of-drug-use" class="nav-link" data-scroll-target="#prevalence-of-drug-use">3. <strong>Prevalence of Drug Use</strong></a></li>
  <li><a href="#health-financial-and-social-impact" id="toc-health-financial-and-social-impact" class="nav-link" data-scroll-target="#health-financial-and-social-impact">4. <strong>Health, Financial, and Social Impact</strong></a></li>
  <li><a href="#geographic-distribution-of-drug-use" id="toc-geographic-distribution-of-drug-use" class="nav-link" data-scroll-target="#geographic-distribution-of-drug-use">5. <strong>Geographic Distribution of Drug Use</strong></a></li>
  <li><a href="#policy-and-enforcement" id="toc-policy-and-enforcement" class="nav-link" data-scroll-target="#policy-and-enforcement">6. <strong>Policy and Enforcement</strong></a></li>
  </ul></li>
  <li><a href="#installing-and-loading-r-packages" id="toc-installing-and-loading-r-packages" class="nav-link" data-scroll-target="#installing-and-loading-r-packages">Installing and loading R packages</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">The data</a></li>
  <li><a href="#understanding-the-data" id="toc-understanding-the-data" class="nav-link" data-scroll-target="#understanding-the-data">Understanding the data</a></li>
  <li><a href="#preparing-data-for-global-measures-of-spatial-autocorrelation" id="toc-preparing-data-for-global-measures-of-spatial-autocorrelation" class="nav-link" data-scroll-target="#preparing-data-for-global-measures-of-spatial-autocorrelation">Preparing data for <strong>Global Measures of Spatial Autocorrelation</strong></a>
  <ul class="collapse">
  <li><a href="#save-derived-data" id="toc-save-derived-data" class="nav-link" data-scroll-target="#save-derived-data">Save Derived data</a></li>
  <li><a href="#read-derived-data" id="toc-read-derived-data" class="nav-link" data-scroll-target="#read-derived-data">Read Derived data</a></li>
  </ul></li>
  <li><a href="#calculating-morans-i" id="toc-calculating-morans-i" class="nav-link" data-scroll-target="#calculating-morans-i">Calculating Moran’s I</a></li>
  <li><a href="#global-measures-of-spatial-association" id="toc-global-measures-of-spatial-association" class="nav-link" data-scroll-target="#global-measures-of-spatial-association">Global measures of Spatial Association</a>
  <ul class="collapse">
  <li><a href="#save-derived-data-1" id="toc-save-derived-data-1" class="nav-link" data-scroll-target="#save-derived-data-1">Save Derived data</a></li>
  <li><a href="#read-derived-data-1" id="toc-read-derived-data-1" class="nav-link" data-scroll-target="#read-derived-data-1">Read Derived data</a></li>
  <li><a href="#computing-global-morani" id="toc-computing-global-morani" class="nav-link" data-scroll-target="#computing-global-morani">Computing Global Moran’I</a></li>
  <li><a href="#performing-global-morans-i-test" id="toc-performing-global-morans-i-test" class="nav-link" data-scroll-target="#performing-global-morans-i-test">Performing Global Moran’s I test</a>
  <ul class="collapse">
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#local-morans-i-lisa-calculation" id="toc-local-morans-i-lisa-calculation" class="nav-link" data-scroll-target="#local-morans-i-lisa-calculation">Local Moran’s I (LISA) calculation</a>
  <ul class="collapse">
  <li><a href="#visualisng-local-morans-i-lisa" id="toc-visualisng-local-morans-i-lisa" class="nav-link" data-scroll-target="#visualisng-local-morans-i-lisa">Visualisng Local Moran’s I (LISA)</a></li>
  </ul></li>
  <li><a href="#computing-local-morans-i" id="toc-computing-local-morans-i" class="nav-link" data-scroll-target="#computing-local-morans-i">Computing Local Moran’s I</a>
  <ul class="collapse">
  <li><a href="#visualising-local-morans-i" id="toc-visualising-local-morans-i" class="nav-link" data-scroll-target="#visualising-local-morans-i">Visualising local Moran’s I</a></li>
  </ul></li>
  <li><a href="#visualisng-lisa-map" id="toc-visualisng-lisa-map" class="nav-link" data-scroll-target="#visualisng-lisa-map">Visualisng LISA map</a>
  <ul class="collapse">
  <li><a href="#global-measures-of-spatial-autocorrelation-gearys-c" id="toc-global-measures-of-spatial-autocorrelation-gearys-c" class="nav-link" data-scroll-target="#global-measures-of-spatial-autocorrelation-gearys-c"><strong>Global Measures of Spatial Autocorrelation: Geary’s C</strong></a></li>
  </ul></li>
  <li><a href="#computing-local-gi-statistics" id="toc-computing-local-gi-statistics" class="nav-link" data-scroll-target="#computing-local-gi-statistics">Computing local Gi* statistics</a>
  <ul class="collapse">
  <li><a href="#save-derived-data-2" id="toc-save-derived-data-2" class="nav-link" data-scroll-target="#save-derived-data-2">Save Derived data</a></li>
  <li><a href="#read-derived-data-2" id="toc-read-derived-data-2" class="nav-link" data-scroll-target="#read-derived-data-2">Read Derived data</a></li>
  </ul></li>
  <li><a href="#conclusion-and-reflection" id="toc-conclusion-and-reflection" class="nav-link" data-scroll-target="#conclusion-and-reflection">Conclusion and Reflection</a>
  <ul class="collapse">
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection">Reflection</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take Home Exercise 2: Application of Geospatial Analysis Methods to Discover Thailand Drug Abuse at the Province Level</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>edwin tan </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="background" class="level1">
<h1>Background</h1>
<section id="geopolitical-context" class="level3">
<h3 class="anchored" data-anchor-id="geopolitical-context">1. <strong>Geopolitical Context</strong></h3>
<ul>
<li><p>Thailand’s proximity to the <strong>Golden Triangle</strong> (the region where the borders of Thailand, Laos, and Myanmar meet) is significant as this area is historically known as a major hub for drug production and trafficking, particularly of opium and heroin. More recently, synthetic drugs like methamphetamine have become prevalent.</p></li>
<li><p>Thailand serves both as a <strong>transit route</strong> for drugs destined for third countries and as a significant <strong>market</strong> for illicit drugs. This geopolitical factor adds complexity to the issue, as it intersects with international drug trafficking networks and the nation’s domestic drug use.</p></li>
</ul>
</section>
<section id="transportation-infrastructure" class="level3">
<h3 class="anchored" data-anchor-id="transportation-infrastructure">2. <strong>Transportation Infrastructure</strong></h3>
<ul>
<li><p>With the continuous development of transportation infrastructure in Thailand, the movement of drugs becomes easier both within the country and across borders. This infrastructure facilitates not only legitimate commerce but also illegal activities, particularly in regions that border drug-producing areas.</p></li>
<li><p>Analysts should consider transportation routes and <strong>connectivity</strong> between provinces, as these might correlate with higher rates of drug abuse or trafficking activity in certain regions.</p></li>
</ul>
</section>
<section id="prevalence-of-drug-use" class="level3">
<h3 class="anchored" data-anchor-id="prevalence-of-drug-use">3. <strong>Prevalence of Drug Use</strong></h3>
<ul>
<li><p>Globally, drug use is on the rise, and Thailand reflects this trend. With <strong>2.7 million youths</strong> reportedly using drugs, and <strong>300,000</strong> needing drug treatment, it’s clear that drug abuse is a pervasive social problem.</p></li>
<li><p>A particular focus should be placed on <strong>youth involvement</strong>, especially among <strong>vocational-school students</strong>, as they show a higher incidence of drug abuse compared to secondary-school students. Analysts may want to explore why this demographic is more vulnerable and how their environment (e.g., educational settings, social circles) contributes to the problem.</p></li>
</ul>
</section>
<section id="health-financial-and-social-impact" class="level3">
<h3 class="anchored" data-anchor-id="health-financial-and-social-impact">4. <strong>Health, Financial, and Social Impact</strong></h3>
<ul>
<li><p>Drug abuse has severe <strong>health consequences</strong>, including addiction, overdose, and the spread of infectious diseases (e.g., HIV, hepatitis).</p></li>
<li><p>The <strong>financial cost</strong> includes both the economic burden on healthcare systems and the loss of productivity, particularly among the youth. Social consequences may include increased crime rates, family breakdowns, and reduced educational and employment opportunities for affected individuals.</p></li>
<li><p><strong>Social services</strong> and the <strong>healthcare system</strong> in Thailand are likely under strain, with increasing demands for drug treatment and rehabilitation programs.</p></li>
</ul>
</section>
<section id="geographic-distribution-of-drug-use" class="level3">
<h3 class="anchored" data-anchor-id="geographic-distribution-of-drug-use">5. <strong>Geographic Distribution of Drug Use</strong></h3>
<ul>
<li><p>By analyzing the <strong>geographic distribution</strong> of drug use cases across provinces, one can identify patterns that may suggest localized factors contributing to drug abuse. This may include proximity to trafficking routes, socio-economic disparities, or regional differences in enforcement or education.</p></li>
<li><p>Analysts should be prepared to look at this distribution in relation to <strong>population density</strong>, economic activity, access to healthcare, and law enforcement effectiveness. Yearly data will also allow for the identification of <strong>trends over time</strong>, such as regions where drug abuse is increasing or decreasing.</p></li>
</ul>
</section>
<section id="policy-and-enforcement" class="level3">
<h3 class="anchored" data-anchor-id="policy-and-enforcement">6. <strong>Policy and Enforcement</strong></h3>
<ul>
<li>Thailand has a strong <strong>anti-drug policy</strong>, including harsh penalties for drug-related offenses. However, the effectiveness of these policies is debatable given the continued rise in drug use. An analyst should consider the impact of these policies, including whether they have driven drug abuse underground or led to unintended consequences, such as higher incarceration rates.</li>
</ul>
<p>In analyzing this data, it is crucial to contextualize it within <strong>regional geopolitics</strong>, <strong>infrastructure development</strong>, <strong>social factors</strong>, and <strong>government responses</strong>. Mapping drug abuse cases by year and province can help to uncover hotspots, trends, and areas where intervention may be most needed. Understanding the <strong>root causes</strong> of drug abuse among vulnerable populations, particularly youths, is also essential in crafting effective policy recommendations and targeted interventions.</p>
</section>
</section>
<section id="installing-and-loading-r-packages" class="level1">
<h1>Installing and loading R packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, spdep, tmap, tidyverse,sfdep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p><strong>sf</strong>: This package is used for handling spatial data in R, allowing for operations on simple features (geometric objects).</p></li>
<li><p><strong>spdep</strong>: This package provides tools for spatial dependence, including functions for spatial weights and models.</p></li>
<li><p><strong>tmap</strong>: A package designed for thematic mapping, making it easy to create static and interactive maps.</p></li>
<li><p><strong>tidyverse</strong>: A collection of R packages designed for data science, including <code>ggplot2</code>, <code>dplyr</code>, and others that simplify data manipulation and visualization.</p></li>
<li><p><strong>sfdep</strong>: This package focuses on spatial dependency, providing tools for estimating spatial autocorrelation and conducting related analyses.</p></li>
</ul>
</section>
<section id="the-data" class="level1">
<h1>The data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>drug_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/thai_drug_offenses_2017_2022.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>read a CSV (Comma-Separated Values) file containing data on drug offenses in Thailand from the years 2017 to 2022. Here’s a breakdown of its components and purpose:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(drug_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  fiscal_year   types_of_drug_offenses    no_cases       province_th       
 Min.   :2017   Length:7392            Min.   :    0.0   Length:7392       
 1st Qu.:2018   Class :character       1st Qu.:    1.0   Class :character  
 Median :2020   Mode  :character       Median :   70.0   Mode  :character  
 Mean   :2020                          Mean   :  535.3                     
 3rd Qu.:2021                          3rd Qu.:  623.0                     
 Max.   :2022                          Max.   :17131.0                     
 province_en       
 Length:7392       
 Class :character  
 Mode  :character  
                   
                   
                   </code></pre>
</div>
</div>
<ul>
<li><p><strong>Fiscal Year</strong>:</p>
<ul>
<li><p>The <code>fiscal_year</code> variable ranges from <strong>2017 to 2022</strong>. This indicates that the dataset covers a total of <strong>6 years</strong> of drug offense data.</p></li>
<li><p>The median year is <strong>2020</strong>, and the mean year is also <strong>2020</strong>, suggesting that the data is centered around this time period.</p></li>
</ul></li>
<li><p><strong>Types of Drug Offenses</strong>:</p>
<ul>
<li><p>The <code>types_of_drug_offenses</code> variable is categorical (character type) and contains a variety of different drug offenses.</p></li>
<li><p>The distribution of types may be analyzed further to determine which types of offenses are most common over the years.</p></li>
</ul></li>
<li><p><strong>Number of Cases (<code>no_cases</code>)</strong>:</p>
<ul>
<li><p>The <code>no_cases</code> variable indicates the number of drug offense cases recorded in the dataset.</p></li>
<li><p><strong>Minimum</strong>: There are instances with <strong>0 cases</strong>, indicating that in some provinces or years, no drug offenses were reported.</p></li>
<li><p><strong>1st Quartile</strong>: The first quartile (25th percentile) shows that <strong>25% of the cases</strong> had <strong>1 or fewer</strong> offenses, indicating low numbers of cases in a substantial portion of the dataset.</p></li>
<li><p><strong>Median</strong>: The median of <strong>70 cases</strong> suggests that half of the entries reported <strong>70 or fewer offenses</strong>, highlighting a significant number of cases in the upper half.</p></li>
<li><p><strong>Mean</strong>: The average number of cases is <strong>535.3</strong>, which is considerably higher than the median, suggesting that there are some provinces or years with exceptionally high numbers of cases that skew the average upwards.</p></li>
<li><p><strong>3rd Quartile</strong>: The third quartile indicates that <strong>75% of the cases</strong> reported <strong>623 or fewer offenses</strong>, reflecting that a smaller portion of the dataset has a much larger number of offenses.</p></li>
<li><p><strong>Maximum</strong>: The maximum number of cases reported is <strong>17,131</strong>, which indicates a significant outlier. This could represent a specific province or year with particularly high drug offenses that may require further investigation.</p></li>
</ul></li>
<li><p><strong>Province</strong>:</p>
<ul>
<li><p>The <code>province_en</code> variable, also categorical, lists the provinces in which the drug offenses occurred. The length of this variable being <strong>7392</strong> indicates that there are multiple entries for different provinces and years.</p></li>
<li><p>Analysis of this variable could reveal geographic patterns of drug offenses, helping identify regions that are more heavily impacted by drug issues.</p></li>
</ul></li>
</ul>
<p>Once the provincial boundaries are loaded into the <code>thailand_provinces</code> variable as a Simple Features (sf) object, it can be used for various analyse</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>thailand_provinces<span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span><span class="st">"data/geospatial"</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">layer =</span> <span class="st">"tha_admbnda_adm1_rtsd_20220121"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `tha_admbnda_adm1_rtsd_20220121' from data source 
  `C:\edwing444\IS415-GAA\Take_Home_Ex\Take_home_ex2\data\geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 77 features and 16 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the ADM1_TH column</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>thailand_provinces <span class="ot">&lt;-</span> thailand_provinces <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>ADM1_TH,<span class="sc">-</span>ADM1_REF,<span class="sc">-</span>ADM1ALT1EN,<span class="sc">-</span>ADM1ALT2EN,<span class="sc">-</span>ADM1ALT1TH,<span class="sc">-</span>ADM1ALT2EN, <span class="sc">-</span>ADM1ALT2TH, <span class="sc">-</span>ADM0_TH) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">province_en =</span> ADM1_EN)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop the province_th column</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>drug_data <span class="ot">&lt;-</span> drug_data <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>province_th)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I simplify the <code>thailand_provinces</code> dataset by removing columns that are not needed for further analysis, thus making the dataset cleaner and more manageable. Also, i rename the <code>ADM1_EN</code> column to <code>province_en</code>, which contains the province names in English. This provides a clearer and more intuitive column name for future analysis.<br>
<br>
Next, I remove the <code>province_th</code> column from the <code>drug_data</code> dataset, likely because it contains redundant or unnecessary information, especially if the <code>thailand_provinces</code> dataset now includes the relevant province information in English. Dropping this column helps streamline the <code>drug_data</code> dataset, focusing on the necessary columns that are crucial for the analysis of drug offenses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>province_grouped <span class="ot">&lt;-</span> drug_data <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fiscal_year, province_en)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Summarize the total drug offenses for each group</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>province_summary <span class="ot">&lt;-</span> province_grouped <span class="sc">%&gt;%</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_offenses =</span> <span class="fu">sum</span>(no_cases, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"keep"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This grouping allows for subsequent calculations to be performed within these groups, making it easier to analyze trends and patterns of drug offenses over time and across different provinces.</p>
<p>The result after summarising is a new data frame <code>province_summary</code> that contains three columns: <code>fiscal_year</code>, <code>province_en</code>, and <code>total_offenses</code>, which reflects the total number of offenses recorded for each province in each fiscal year.</p>
<p>The argument <code>.groups = "keep"</code> retains the grouping structure of the original data frame in the summarized output, which may be useful for further analysis or visualizations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join the drug abuse data with province polygons</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> thailand_provinces <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(drug_data, <span class="at">by =</span> <span class="st">"province_en"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now I will merge the two datasets in a way that retains all the rows from the <code>thailand_provinces</code> dataset and includes matching rows from the <code>drug_data</code> dataset based on the <code>province_en</code> column.</p>
<ul>
<li>If a province in <code>thailand_provinces</code> does not have corresponding data in <code>drug_data</code>, the resulting <code>combined_data</code> will still include that province, but the columns from <code>drug_data</code> will contain <code>NA</code> (missing values).</li>
</ul>
<p>The purpose of this operation is to create a combined dataset that integrates geographic information about the provinces with the corresponding drug offense data. This integration is used for mapping the data to <strong>understand how the data looks like</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join the drug abuse province data with province polygons</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>combined_province_data <span class="ot">&lt;-</span> thailand_provinces <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(province_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(province_en)`</code></pre>
</div>
</div>
<p>The above merges the geographic data of provinces with the summarized drug offense data to create a comprehensive dataset that includes both spatial and analytical information.</p>
<ul>
<li><p>The join is done based on the common columns present in both datasets. Since <code>province_summary</code> is assumed to have the <code>province_en</code> column, it will merge the summarized drug offense totals for each province.</p></li>
<li><p>If there are provinces in <code>thailand_provinces</code> that do not have corresponding entries in <code>province_summary</code>, they will still be included in the resulting dataset (<code>combined_province_data</code>), but the columns from <code>province_summary</code> will contain <code>NA</code> (missing values).</p></li>
</ul>
<p>This integration is essential for <strong>spatial analysis and for visualizing the data on maps</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>combined_province_data <span class="ot">&lt;-</span> combined_province_data <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(total_offenses))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now I clean the dataset by excluding any entries that do not have a valid total number of drug offenses.</p>
<p>Removing rows with <code>NA</code> values in the <code>total_offenses</code> column ensures that subsequent analyses or visualizations are based on complete data, leading to more accurate and reliable results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">st_geometry_type</span>(combined_province_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
  [6] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [11] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [16] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [21] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [26] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [31] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [36] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [41] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [46] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [51] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [56] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [61] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [66] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [71] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [76] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [81] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [86] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [91] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
 [96] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[101] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[106] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[111] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[116] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[121] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[126] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[131] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[136] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[141] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[146] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[151] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[156] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[161] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[166] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[171] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[176] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[181] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[186] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[191] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[196] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[201] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[206] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[211] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[216] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[221] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[226] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[231] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[236] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[241] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[246] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[251] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[256] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[261] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[266] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[271] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[276] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[281] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[286] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[291] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[296] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[301] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[306] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[311] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[316] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[321] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[326] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[331] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[336] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[341] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[346] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[351] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[356] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[361] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[366] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[371] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[376] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[381] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[386] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[391] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[396] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[401] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[406] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[411] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[416] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[421] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[426] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[431] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[436] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[441] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
[446] MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON MULTIPOLYGON
18 Levels: GEOMETRY POINT LINESTRING POLYGON MULTIPOINT ... TRIANGLE</code></pre>
</div>
</div>
<p>It is “MULTIPOLYGON”, it signifies that some provinces may consist of multiple, non-contiguous areas.</p>
</section>
<section id="understanding-the-data" class="level1">
<h1>Understanding the data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a choropleth map using tmap</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(combined_province_data) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"total_offenses"</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">title =</span> <span class="st">"Number of Cases"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">palette =</span> <span class="st">"Blues"</span>, </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">style =</span> <span class="st">"quantile"</span>, </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"fiscal_year"</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">free.coords =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Drug Offense Cases in Thailand by Province and Fiscal Year"</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.5</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="take_home_ex2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ol type="1">
<li><p><strong>Spatial Distribution:</strong></p>
<ul>
<li><p><strong>Northern Thailand:</strong> Consistently shows higher rates of drug offenses throughout the depicted years.</p></li>
<li><p><strong>Southern Thailand:</strong> Exhibits a mix of high and low rates, with some provinces experiencing significant spikes in certain years.</p></li>
<li><p><strong>Central Thailand:</strong> Generally has lower rates compared to the north and south, though there are fluctuations.</p></li>
</ul></li>
<li><p><strong>Temporal Trends:</strong></p>
<ul>
<li><p><strong>2017-2019:</strong> A general increase in drug offense cases is observed across most provinces.</p></li>
<li><p><strong>2020:</strong> A slight decrease is seen in some regions, potentially due to COVID-19 restrictions or other factors.</p></li>
<li><p><strong>2021-2022:</strong> Data is missing for 2022, making a complete analysis difficult. However, 2021 shows a continuation of trends from previous years.</p></li>
</ul></li>
<li><p><strong>Hotspots:</strong></p>
<ul>
<li><p><strong>Northern Provinces:</strong> Chiang Mai, Chiang Rai, and Mae Hong Son consistently appear as hotspots with high levels of drug offenses.</p></li>
<li><p><strong>Southern Provinces:</strong> Provinces like Yala, Pattani, and Narathiwat often show elevated rates, particularly in certain years.</p></li>
</ul></li>
</ol>
<p><strong>Potential Explanations and Further Analysis:</strong></p>
<ul>
<li><p><strong>Geographical Factors:</strong> Proximity to borders with neighboring countries, especially Myanmar and Laos, could influence drug trafficking routes and hence, higher rates of offenses.</p></li>
<li><p><strong>Socioeconomic Conditions:</strong> Poverty, unemployment, and lack of educational opportunities might be contributing factors in regions with high rates.</p></li>
<li><p><strong>Governance and Law Enforcement:</strong> The effectiveness of law enforcement agencies and anti-drug initiatives could vary across different regions.</p></li>
<li><p><strong>Drug Production and Trafficking:</strong> Understanding the specific types of drugs involved and their production/trafficking routes could provide valuable insights.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: KDE (if you have point data)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(combined_province_data) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"total_offenses"</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">title =</span> <span class="st">"Number of Drug Cases"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">palette =</span> <span class="st">"Oranges"</span>, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">style =</span> <span class="st">"cont"</span>) <span class="sc">+</span>  <span class="co"># Continuous color scale</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"KDE Map of Drug Offense Density"</span>, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="take_home_ex2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ol type="1">
<li><p><strong>Spatial Clustering:</strong></p>
<ul>
<li><p><strong>Northern Thailand:</strong> Exhibits the highest density of drug offenses, with clusters forming in regions like Chiang Mai, Chiang Rai, and Mae Hong Son.</p></li>
<li><p><strong>Southern Thailand:</strong> Also shows significant clustering, particularly in the provinces of Yala, Pattani, and Narathiwat.</p></li>
<li><p><strong>Central Thailand:</strong> Generally has lower densities, with scattered clusters in some areas.</p></li>
</ul></li>
<li><p><strong>Density Gradients:</strong></p>
<ul>
<li><p>The map clearly illustrates gradients in drug offense density, with darker shades indicating higher concentrations and lighter shades representing lower concentrations.</p></li>
<li><p>These gradients provide a visual representation of the spatial distribution of drug offenses across the country.</p></li>
</ul></li>
</ol>
<p><strong>Potential Explanations and Further Analysis:</strong></p>
<ul>
<li><p><strong>Geographical Factors:</strong> Proximity to borders with neighboring countries, such as Myanmar and Laos, could influence drug trafficking routes and contribute to higher densities in those regions.</p></li>
<li><p><strong>Socioeconomic Conditions:</strong> Poverty, unemployment, and lack of educational opportunities might be correlated with higher drug offense rates.</p></li>
<li><p><strong>Governance and Law Enforcement:</strong> The effectiveness of law enforcement agencies and anti-drug initiatives could vary across different regions, impacting the density of drug offenses.</p></li>
<li><p><strong>Drug Production and Trafficking:</strong> Understanding the specific types of drugs involved and their production/trafficking routes could provide valuable insights into the spatial patterns.</p></li>
</ul>
</section>
<section id="preparing-data-for-global-measures-of-spatial-autocorrelation" class="level1">
<h1>Preparing data for <strong>Global Measures of Spatial Autocorrelation</strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|eval: false</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create neighbors list</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>neighbors <span class="ot">&lt;-</span> <span class="fu">st_contiguity</span>(combined_province_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I create a <strong>contiguity-based neighbors list</strong> for spatial analysis</p>
<p><code>st_contiguity()</code> is part of the <strong>sfdep</strong> package, which is designed for working with spatial dependencies.</p>
<ul>
<li><p><strong>Contiguity</strong> refers to spatial units (in this case, provinces) that share common boundaries. When two provinces share a border, they are considered “neighbors.”</p></li>
<li><p>The function creates a list of neighboring provinces based on their shared borders.</p></li>
</ul>
<p>The result is a list where each province has an associated set of neighboring provinces.<br>
</p>
<section id="save-derived-data" class="level3">
<h3 class="anchored" data-anchor-id="save-derived-data">Save Derived data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(neighbors,<span class="st">"data/rds/neighbors.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-derived-data" class="level3">
<h3 class="anchored" data-anchor-id="read-derived-data">Read Derived data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>neighbors<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/rds/neighbors.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(combined_province_data<span class="sc">$</span>total_offenses)  <span class="co"># Check the length of your data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 450</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(neighbors)  <span class="co"># Check the number of units in the spatial weights matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 450</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>listw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(neighbors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we convert a <strong>neighbors list</strong> (such as the one I created earlier with <code>st_contiguity()</code>) into a <strong>spatial weights matrix</strong> (stored as <code>listw</code>). This is an important step in spatial analysis because it allows me to quantify the relationships between geographic units (in this case, provinces) in terms of spatial dependence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert neighbors list to weights list</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>weights_list <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(neighbors, <span class="at">style =</span> <span class="st">"W"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This command converts the <strong>neighbors list</strong> into a <strong>spatial weights matrix</strong> (stored as <code>weights_list</code>), where the weights are row-standardized. The weights matrix is used for spatial analysis tasks like calculating spatial autocorrelation or running spatial regression models.</p>
</section>
</section>
<section id="calculating-morans-i" class="level1">
<h1>Calculating Moran’s I</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Moran's I</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>moran_result <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(combined_province_data<span class="sc">$</span>total_offenses, listw)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(moran_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  combined_province_data$total_offenses  
weights: listw    

Moran I statistic standard deviate = 16.077, p-value &lt; 2.2e-16
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
     0.1903562142     -0.0022271715      0.0001434901 </code></pre>
</div>
</div>
<p><strong>Moran’s I</strong> is a measure of spatial autocorrelation, which indicates whether values of a variable at nearby locations are more similar or more different than expected by chance. It ranges from -1 to 1</p>
<p><strong>Output Interpretation:</strong></p>
<ul>
<li><p><strong>Moran I statistic:</strong> 0.1903562142 - This value suggests a weak positive spatial autocorrelation. It means that provinces with higher rates of total offenses tend to be located near other provinces with higher rates.</p></li>
<li><p><strong>Standard deviate:</strong> 16.077 - This is the standard deviation of the Moran’s I statistic under random permutations. It provides a measure of variability around the expected value of 0 under no autocorrelation.</p></li>
<li><p><strong>p-value:</strong> &lt; 2.2e-16 - This extremely small p-value indicates that the observed Moran’s I statistic is highly unlikely to occur by chance if there were no spatial autocorrelation. It provides strong evidence for the existence of spatial clustering in the data.</p></li>
<li><p><strong>Expectation and Variance:</strong> These values represent the expected value and variance of the Moran’s I statistic under random permutations. They are used to assess the significance of the observed statistic.</p></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p>The analysis suggests that there is a weak positive spatial autocorrelation in the distribution of total offenses across the provinces in the dataset. This means that provinces with higher rates of total offenses tend to be clustered together geographically. This finding may be indicative of underlying spatial processes or factors that influence the distribution of total offenses</p>
</section>
<section id="global-measures-of-spatial-association" class="level1">
<h1>Global measures of Spatial Association</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|eval: false</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>wm_thai_g <span class="ot">&lt;-</span> combined_province_data <span class="sc">%&gt;%</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nb=</span><span class="fu">st_contiguity</span>(geometry),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">wt=</span><span class="fu">st_weights</span>(nb,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">style=</span><span class="st">"W"</span>),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="save-derived-data-1" class="level3">
<h3 class="anchored" data-anchor-id="save-derived-data-1">Save Derived data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(wm_thai_g,<span class="st">"data/rds/wm_thai_g.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-derived-data-1" class="level3">
<h3 class="anchored" data-anchor-id="read-derived-data-1">Read Derived data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>wm_thai_g<span class="ot">&lt;-</span><span class="fu">read_rds</span>(<span class="st">"data/rds/wm_thai_g.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="computing-global-morani" class="level2">
<h2 class="anchored" data-anchor-id="computing-global-morani">Computing Global Moran’I</h2>
<p>global_moran() function is used to compute Moran’s I value. Different from sdep package, the output is a tibble data.frame</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>moranI <span class="ot">&lt;-</span> <span class="fu">global_moran</span>(wm_thai_g<span class="sc">$</span>total_offenses,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                       wm_thai_g<span class="sc">$</span>nb,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                       wm_thai_g<span class="sc">$</span>wt)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(moranI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 2
 $ I: num 0.19
 $ K: num 21.8</code></pre>
</div>
</div>
<p><strong>Output Interpretation:</strong></p>
<ul>
<li><p><strong>$ I: num 0.19</strong>: This indicates that the calculated Global Moran’s I statistic is 0.19. This suggests a weak positive spatial autocorrelation, meaning that provinces with higher rates of total offenses tend to be clustered together geographically.</p></li>
<li><p><strong>$ K: num 21.8</strong>: This is the Z-score associated with the Moran’s I statistic. It provides a standardized measure of the significance of the observed spatial autocorrelation. A Z-score of 21.8 is generally considered to be statistically significant, suggesting that the observed spatial clustering is unlikely to occur by chance.</p></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p>The analysis suggests that there is a weak positive spatial autocorrelation in the distribution of total offenses across the provinces in the dataset. This means that provinces with higher rates of total offenses tend to be clustered together geographically. This finding may be indicative of underlying spatial processes or factors that influence the distribution of total offenses.</p>
</section>
<section id="performing-global-morans-i-test" class="level2">
<h2 class="anchored" data-anchor-id="performing-global-morans-i-test">Performing Global Moran’s I test</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_test</span>(wm_thai_g<span class="sc">$</span>total_offenses,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                       wm_thai_g<span class="sc">$</span>nb,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                       wm_thai_g<span class="sc">$</span>wt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  x  
weights: listw    

Moran I statistic standard deviate = 16.077, p-value &lt; 2.2e-16
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
     0.1903562142     -0.0022271715      0.0001434901 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">global_moran_perm</span>(wm_thai_g<span class="sc">$</span>total_offenses,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                       wm_thai_g<span class="sc">$</span>nb,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                       wm_thai_g<span class="sc">$</span>wt,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nsim =</span> <span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 100 

statistic = 0.19036, observed rank = 100, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p><strong>Output Interpretation:</strong></p>
<ol type="1">
<li><p><strong>p-value</strong>:</p>
<ul>
<li><p>The p-value is <strong>&lt; 2.2e-16</strong>, which is extremely small.</p></li>
<li><p>This very low p-value suggests that the observed spatial autocorrelation is statistically significant. We can <strong>reject the null hypothesis</strong> that there is no spatial autocorrelation.</p></li>
</ul></li>
<li><p><strong>Interpretation of the Hypothesis Test</strong>:</p>
<ul>
<li><p>The alternative hypothesis is <strong>greater</strong>, meaning the test is checking whether there is significant positive spatial autocorrelation.</p></li>
<li><p>Since the Moran’s I value is positive and the p-value is extremely low, there is significant evidence to conclude that <strong>positive spatial autocorrelation exists</strong> in the drug offense data.</p></li>
</ul></li>
<li><p><strong>Moran I statistic:</strong> 0.1903562142 - This indicates that the calculated Global Moran’s I statistic is 0.19. This suggests a weak positive spatial autocorrelation, meaning that provinces with higher rates of total offenses tend to be clustered together geographically.</p></li>
<li><p><strong>Standard deviate:</strong> 16.077 - This is the standard deviation of the Moran’s I statistic under random permutations. It provides a measure of variability around the expected value of 0 under no autocorrelation.</p></li>
<li><p><strong>Sample estimates:</strong></p>
<ul>
<li><p><strong>Expectation:</strong> -0.0022271715 - This is the expected value of the Moran’s I statistic under random permutations.</p></li>
<li><p><strong>Variance:</strong> 0.0001434901 - This is the variance of the Moran’s I statistic under random permutations.</p></li>
</ul></li>
</ol>
<section id="conclusion" class="level3">
<h3 class="anchored" data-anchor-id="conclusion">Conclusion</h3>
<p>The test results suggest that drug offenses in Thailand are <strong>spatially clustered</strong> rather than randomly dispersed. There is a moderate level of clustering of similar values (provinces with similar levels of offenses are located near each other), and this result is statistically significant.</p>
</section>
</section>
</section>
<section id="local-morans-i-lisa-calculation" class="level1">
<h1>Local Moran’s I (LISA) calculation</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Local Moran's I (LISA) calculation</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>local_moran <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(combined_province_data<span class="sc">$</span>total_offenses, listw)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(local_moran)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Ii          E.Ii      Var.Ii     Z.Ii Pr(z != E(Ii))
1 3.915244 -0.0980888574 0.884289023 4.267839   1.973754e-05
2 4.433758 -0.1405926984 1.207737668 4.162394   3.149282e-05
3 4.036029 -0.1067510040 0.953136961 4.243403   2.201559e-05
4 2.934944 -0.0468413687 0.446278092 4.463480   8.063904e-06
5 2.449271 -0.0305306590 0.295856466 4.559071   5.138033e-06
6 0.363538 -0.0005377416 0.005372184 4.967253   6.790805e-07</code></pre>
</div>
</div>
<p><strong>Interpretation of Results:</strong></p>
<ul>
<li><p><strong>Ii values:</strong> Positive values indicate clustering of similar values (hotspots or coldspots), while negative values indicate dispersion of dissimilar values.</p></li>
<li><p><strong>Z.Ii and Pr(z != E(Ii))</strong>: High Z-scores and low p-values suggest statistically significant clustering or dispersion.</p></li>
</ul>
<section id="visualisng-local-morans-i-lisa" class="level2">
<h2 class="anchored" data-anchor-id="visualisng-local-morans-i-lisa">Visualisng Local Moran’s I (LISA)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Local Moran's I (LISA) calculation</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>lisa <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(combined_province_data<span class="sc">$</span>total_offenses, <span class="at">listw =</span> weights_list)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>combined_province_data<span class="sc">$</span>lisa <span class="ot">&lt;-</span> lisa[, <span class="st">"Ii"</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set tmap mode to interactive or static</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)  <span class="co"># Use "view" for interactive</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a thematic map to visualize Local Moran's I</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(combined_province_data) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"lisa"</span>, <span class="at">palette =</span> <span class="st">"viridis"</span>, <span class="at">title =</span> <span class="st">"Local Moran's I (LISA)"</span>) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Local Moran's I (LISA) for Drug Abuse in Thailand Provinces"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="take_home_ex2_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ol type="1">
<li><p><strong>Spatial Clustering:</strong></p>
<ul>
<li><p><strong>Northern Thailand:</strong> Exhibits several hotspots (darker shades) and coldspots (lighter shades) indicating significant clustering or dispersion of drug abuse cases.</p></li>
<li><p><strong>Southern Thailand:</strong> Shows similar patterns, with both hotspots and coldspots present.</p></li>
<li><p><strong>Central Thailand:</strong> Appears to have a more scattered distribution, with fewer pronounced clusters.</p></li>
</ul></li>
<li><p><strong>Hotspots and Coldspots:</strong></p>
<ul>
<li><p><strong>Hotspots:</strong> Provinces with darker shades likely represent regions with higher drug abuse rates and a tendency to cluster with other regions of high drug abuse.</p></li>
<li><p><strong>Coldspots:</strong> Provinces with lighter shades likely represent regions with lower drug abuse rates and a tendency to cluster with other regions of low drug abuse.</p></li>
</ul></li>
</ol>
<p><strong>Potential Explanations and Further Analysis:</strong></p>
<ul>
<li><p><strong>Geographical Factors:</strong> Proximity to borders with neighboring countries, such as Myanmar and Laos, could influence drug trafficking routes and contribute to clustering in those regions.</p></li>
<li><p><strong>Socioeconomic Conditions:</strong> Poverty, unemployment, and lack of educational opportunities might be correlated with higher drug abuse rates and clustering.</p></li>
<li><p><strong>Governance and Law Enforcement:</strong> The effectiveness of law enforcement agencies and anti-drug initiatives could vary across different regions, impacting the spatial distribution of drug abuse.</p></li>
<li><p><strong>Drug Production and Trafficking:</strong> Understanding the specific types of drugs involved and their production/trafficking routes could provide valuable insights into the spatial patterns.</p></li>
</ul>
</section>
</section>
<section id="computing-local-morans-i" class="level1">
<h1>Computing Local Moran’s I</h1>
<p>Learn how to compute Local Moran’s I of GDPPC at county level by using local_moran() of sfdep package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>lisa <span class="ot">&lt;-</span> wm_thai_g <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    total_offenses,nb,wt,<span class="at">nsim=</span><span class="dv">99</span>),</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(local_moran)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="visualising-local-morans-i" class="level2">
<h2 class="anchored" data-anchor-id="visualising-local-morans-i">Visualising local Moran’s I</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'plot'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa)<span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">'ii'</span>)<span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"local Moran's I of G"</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="dv">2</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>map2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa)<span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">'p_ii'</span>,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.001</span>,<span class="fl">0.01</span>,<span class="fl">0.05</span>,<span class="dv">1</span>),</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001"</span>,<span class="st">"0.01"</span>,<span class="st">"0.05"</span>,<span class="st">"Not Sig"</span>))<span class="sc">+</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"p=value of local Moran's I "</span>,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">0.8</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(map1,map2,<span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "ii" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="take_home_ex2_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Observations:</strong></p>
<p><strong>Map 1: Local Moran’s I (Ii)</strong></p>
<ul>
<li><p><strong>Spatial Clustering:</strong> The map shows clear spatial clusters of high and low values of Local Moran’s I, indicating significant clustering or dispersion of drug abuse cases.</p></li>
<li><p><strong>Hotspots:</strong> Provinces with darker shades (4 to 5) likely represent regions with high drug abuse rates and a tendency to cluster with other regions of high drug abuse.</p></li>
<li><p><strong>Coldspots:</strong> Provinces with lighter shades (1 to 0) likely represent regions with lower drug abuse rates and a tendency to cluster with other regions of low drug abuse.</p></li>
</ul>
<p><strong>Map 2: p-value of Local Moran’s I (p_ii)</strong></p>
<ul>
<li><p><strong>Statistical Significance:</strong> The map highlights provinces where the Local Moran’s I statistic is statistically significant at different levels (0.001, 0.01, 0.05).</p></li>
<li><p><strong>Significant Clusters:</strong> Provinces with p-values less than 0.05 indicate significant clustering or dispersion, suggesting that the observed patterns are unlikely to occur by chance.</p></li>
</ul>
<p><strong>Combined Analysis:</strong></p>
<ul>
<li><p>By comparing the two maps, we can identify provinces that are not only clustered but also have statistically significant clustering.</p></li>
<li><p>These provinces may be considered strong hotspots or coldspots for drug abuse.</p></li>
</ul>
</section>
</section>
<section id="visualisng-lisa-map" class="level1">
<h1>Visualisng LISA map</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>lisa_sig <span class="ot">&lt;-</span> lisa <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_ii <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(lisa)<span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()<span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(lisa_sig)<span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"mean"</span>)<span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="take_home_ex2_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ol type="1">
<li><p><strong>Spatial Clustering:</strong> The map clearly illustrates distinct clusters of provinces based on the Local Moran’s I statistic, suggesting significant spatial autocorrelation in the distribution of drug abuse.</p></li>
<li><p><strong>High-High Clusters:</strong> Provinces in the northern and southern regions appear to form high-high clusters, indicating that these areas have high drug abuse rates and are surrounded by other regions with high drug abuse.</p></li>
<li><p><strong>Low-Low Clusters:</strong> Some provinces in the central and southern regions seem to form low-low clusters, suggesting that these areas have low drug abuse rates and are surrounded by other regions with low drug abuse.</p></li>
<li><p><strong>Mixed Clusters:</strong> There are also provinces that exhibit mixed patterns, such as low-high or high-low clusters, indicating more complex spatial relationships.</p></li>
</ol>
<section id="global-measures-of-spatial-autocorrelation-gearys-c" class="level2">
<h2 class="anchored" data-anchor-id="global-measures-of-spatial-autocorrelation-gearys-c"><strong>Global Measures of Spatial Autocorrelation: Geary’s C</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geary.test</span>(combined_province_data<span class="sc">$</span>total_offenses, <span class="at">listw=</span>weights_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Geary C test under randomisation

data:  combined_province_data$total_offenses 
weights: weights_list   

Geary C statistic standard deviate = 3.8101, p-value = 6.945e-05
alternative hypothesis: Expectation greater than statistic
sample estimates:
Geary C statistic       Expectation          Variance 
       0.87943531        1.00000000        0.00100129 </code></pre>
</div>
</div>
<p><strong>Output Interpretation:</strong></p>
<ul>
<li><p><strong>Geary C statistic:</strong> 0.87943531 - This value suggests a moderate positive spatial autocorrelation. It means that provinces with higher rates of total offenses tend to be located near other provinces with higher rates.</p></li>
<li><p><strong>Standard deviate:</strong> 3.8101 - This is the standard deviation of the Geary’s C statistic under random permutations. It provides a measure of variability around the expected value of 1 under no autocorrelation.</p></li>
<li><p><strong>p-value:</strong> 6.945e-05 - This small p-value indicates that the observed Geary’s C statistic is unlikely to occur by chance if there were no spatial autocorrelation. It provides evidence for the existence of spatial clustering in the data.</p></li>
<li><p><strong>Alternative hypothesis:</strong> Expectation greater than statistic - This indicates that the alternative hypothesis is that the expected value of Geary’s C is greater than the observed statistic, suggesting positive spatial autocorrelation.</p></li>
<li><p><strong>Sample estimates:</strong></p>
<ul>
<li><p><strong>Expectation:</strong> 1.00000000 - This is the expected value of Geary’s C under random permutations.</p></li>
<li><p><strong>Variance:</strong> 0.00100129 - This is the variance of Geary’s C under random permutations.</p></li>
</ul></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p>The analysis suggests that there is a moderate positive spatial autocorrelation in the distribution of total offenses across the provinces in the dataset. This means that provinces with higher rates of total offenses tend to be clustered together geographically. This finding may be indicative of underlying spatial processes or factors that influence the distribution of total offenses.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>bperm_GC<span class="ot">=</span><span class="fu">geary.mc</span>(combined_province_data<span class="sc">$</span>total_offenses, </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">listw=</span>weights_list, </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">nsim=</span><span class="dv">999</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>bperm_GC</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Geary C

data:  combined_province_data$total_offenses 
weights: weights_list  
number of simulations + 1: 1000 

statistic = 0.87944, observed rank = 1, p-value = 0.001
alternative hypothesis: greater</code></pre>
</div>
</div>
<p><code>set.seed(1234)</code>: This sets the random seed to ensure reproducibility of the results.</p>
<p><strong>Output Interpretation:</strong></p>
<ul>
<li><p><strong>Monte-Carlo simulation of Geary C:</strong> This indicates that a Monte Carlo permutation test was conducted to assess the statistical significance of the Geary’s C statistic.</p></li>
<li><p><strong>data: combined_province_data$total_offenses</strong>: This indicates that the variable of interest is <code>total_offenses</code>.</p></li>
<li><p><strong>weights: weights_list</strong>: This indicates that the spatial weights matrix used is <code>weights_list</code>.</p></li>
<li><p><strong>number of simulations + 1: 1000</strong>: This indicates that the total number of simulations performed was 1000 (including the observed data).</p></li>
<li><p><strong>statistic = 0.87944</strong>: This is the observed Geary’s C statistic.</p></li>
<li><p><strong>observed rank = 1</strong>: This indicates that the observed Geary’s C statistic is the largest (or smallest, depending on the alternative hypothesis) out of all 1000 simulated values.</p></li>
<li><p><strong>p-value = 0.001</strong>: This small p-value indicates that the observed Geary’s C statistic is highly unlikely to occur by chance if there were no spatial autocorrelation. It provides strong evidence for the existence of spatial clustering in the data.</p></li>
<li><p><strong>alternative hypothesis: greater</strong>: This specifies that the alternative hypothesis is that the expected value of Geary’s C is greater than the observed statistic, suggesting positive spatial autocorrelation.</p></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p>The analysis suggests that there is a strong positive spatial autocorrelation in the distribution of total offenses across the provinces in the dataset. This means that provinces with higher rates of total offenses tend to be clustered together geographically. This finding is statistically significant, as evidenced by the small p-value from the Monte Carlo permutation test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm_GC<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="st">"Simulated Geary c"</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="take_home_ex2_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ol type="1">
<li><p><strong>Distribution:</strong> The histogram shows a roughly bell-shaped distribution, suggesting that the simulated Geary’s C values are approximately normally distributed.</p></li>
<li><p><strong>Central Tendency:</strong> The distribution appears to be centered around a value slightly greater than 1.0, indicating that the majority of simulated values are close to 1.0.</p></li>
<li><p><strong>Spread:</strong> The distribution is relatively narrow, suggesting that the simulated values are not highly dispersed.</p></li>
<li><p><strong>Observed Statistic:</strong> The red vertical line represents the observed Geary’s C statistic. It is located towards the right tail of the distribution, indicating that the observed value is relatively high compared to the simulated values.</p></li>
</ol>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p><strong>Normality:</strong> The approximately normal distribution of the simulated Geary’s C values suggests that the Monte Carlo permutation test is valid and that the p-value calculated from the test is reliable.</p></li>
<li><p><strong>Central Tendency:</strong> The fact that the majority of simulated values are close to 1.0 indicates that under random permutations, Geary’s C tends to be close to 1.0, which is the expected value under no spatial autocorrelation.</p></li>
<li><p><strong>Spread:</strong> The relatively narrow distribution suggests that the simulated values are not highly dispersed, which is expected given the nature of the Monte Carlo permutation test.</p></li>
<li><p><strong>Observed Statistic:</strong> The location of the observed Geary’s C statistic in the right tail of the distribution indicates that it is significantly different from the simulated values. This suggests that the observed spatial autocorrelation is unlikely to occur by chance.</p></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p>The histogram provides visual evidence for the statistical significance of the observed Geary’s C statistic. The distribution of simulated values is approximately normal, centered around 1.0, and relatively narrow. The observed Geary’s C statistic is located in the right tail of the distribution, indicating that it is significantly different from the simulated values, supporting the conclusion of positive spatial autocorrelation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>bperm<span class="ot">=</span> <span class="fu">moran.mc</span>(combined_province_data<span class="sc">$</span>total_offenses, </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">listw=</span>weights_list, </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">999</span>, </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.action=</span>na.omit)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>bperm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  combined_province_data$total_offenses 
weights: weights_list  
number of simulations + 1: 1000 

statistic = 0.19036, observed rank = 1000, p-value = 0.001
alternative hypothesis: greater</code></pre>
</div>
</div>
<p>Similiarly, function <code>moran.mc</code> performs a Monte Carlo permutation test to assess the statistical significance of the observed Moran’s I statistic.</p>
<p><strong>Output Interpretation:</strong></p>
<ul>
<li><p><strong>Monte-Carlo simulation of Moran I:</strong> This indicates that a Monte Carlo permutation test was conducted to assess the statistical significance of the Moran’s I statistic.</p></li>
<li><p><strong>data: combined_province_data$total_offenses</strong>: This indicates that the variable of interest is <code>total_offenses</code>.</p></li>
<li><p><strong>weights: weights_list</strong>: This indicates that the spatial weights matrix used is <code>weights_list</code>.</p></li>
<li><p><strong>number of simulations + 1: 1000</strong>: This indicates that the total number of simulations performed was 1000 (including the observed data).</p></li>
<li><p><strong>statistic = 0.19036</strong>: This is the observed Moran’s I statistic.</p></li>
<li><p><strong>observed rank 1000</strong>: This indicates that the observed Moran’s I statistic is the largest (or smallest, depending on the alternative hypothesis) out of all 1000 simulated values.</p></li>
<li><p><strong>p-value = 0.001</strong>: This small p-value indicates that the observed Moran’s I statistic is highly unlikely to occur by chance if there were no spatial autocorrelation. It provides strong evidence for the existence of spatial clustering in the data.</p></li>
<li><p><strong>alternative hypothesis: greater</strong>: This specifies that the alternative hypothesis is that the expected value of Moran’s I is greater than the observed statistic, suggesting positive spatial autocorrelation.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.002503914</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm<span class="sc">$</span>res, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq=</span><span class="cn">TRUE</span>, </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Simulated Moran's I"</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="take_home_ex2_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ol type="1">
<li><p><strong>Distribution:</strong> The histogram shows a right-skewed distribution, meaning that there is a longer tail to the right. This indicates that the simulated Moran’s I values are more likely to be higher than the mean.</p></li>
<li><p><strong>Central Tendency:</strong> The distribution appears to be centered around a value slightly greater than 0, suggesting that the majority of simulated values are close to 0.</p></li>
<li><p><strong>Spread:</strong> The distribution is relatively wide, indicating that the simulated values are dispersed over a wider range.</p></li>
<li><p><strong>Observed Statistic:</strong> The red vertical line represents the observed Moran’s I statistic. It is located towards the right tail of the distribution, indicating that the observed value is relatively high compared to the simulated values.</p></li>
</ol>
<p><strong>Interpretation:</strong></p>
<ul>
<li><p><strong>Skewness:</strong> The right-skewed distribution suggests that there are some simulated values that are significantly higher than the majority of the others. This could be due to the presence of strong spatial clusters or other factors influencing the distribution of Moran’s I.</p></li>
<li><p><strong>Central Tendency:</strong> The fact that the majority of simulated values are close to 0 indicates that under random permutations, Moran’s I tends to be close to 0, which is the expected value under no spatial autocorrelation.</p></li>
<li><p><strong>Spread:</strong> The relatively wide distribution suggests that the simulated values are not highly dispersed, which is expected given the nature of the Monte Carlo permutation test.</p></li>
<li><p><strong>Observed Statistic:</strong> The location of the observed Moran’s I statistic in the right tail of the distribution indicates that it is significantly different from the simulated values. This suggests that the observed spatial autocorrelation is unlikely to occur by chance.</p></li>
</ul>
<p><strong>Conclusion:</strong></p>
<p>The histogram provides visual evidence for the statistical significance of the observed Moran’s I statistic. The right-skewed distribution of simulated values suggests that the observed value is relatively high compared to the majority of the simulated values, supporting the conclusion of positive spatial autocorrelation.</p>
<section id="mapping-the-local-morans-i" class="level4">
<h4 class="anchored" data-anchor-id="mapping-the-local-morans-i">Mapping the local Moran’s I</h4>
<p>Before mapping the local Moran’s I map, it is wise to append the local Moran’s I dataframe (i.e.&nbsp;localMI) onto hunan SpatialPolygonDataFrame. The code chunks below can be used to perform the task. The out SpatialPolygonDataFrame is called <em>hunan.localMI</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>province.localMI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(combined_province_data,local_moran) <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Pr.Ii =</span> Pr.z....E.Ii..)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using choropleth mapping functions of <strong>tmap</strong> package, we can plot the local Moran’s I values by using the code chunks below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(province.localMI) <span class="sc">+</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Ii"</span>, </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdBu"</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local moran statistics"</span>) <span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "Ii" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="take_home_ex2_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ol type="1">
<li><p><strong>Spatial Clustering:</strong> The map clearly illustrates distinct clusters of provinces based on the Local Moran’s I statistic, suggesting significant spatial autocorrelation in the underlying variable (likely drug offenses, based on the previous context).</p></li>
<li><p><strong>Hotspots and Coldspots:</strong></p>
<ul>
<li><p><strong>Hotspots:</strong> Provinces in the northern and southern regions appear to form hotspots (darker shades), indicating that these areas have high values of the variable and are surrounded by other regions with high values.</p></li>
<li><p><strong>Coldspots:</strong> Some provinces in the central and southern regions seem to form coldspots (lighter shades), suggesting that these areas have low values of the variable and are surrounded by other regions with low values.</p></li>
</ul></li>
<li><p><strong>Mixed Clusters:</strong> There are also provinces that exhibit mixed patterns, such as low-high or high-low clusters, indicating more complex spatial relationships.</p></li>
</ol>
<p><strong>Potential Explanations and Further Analysis:</strong></p>
<p>Given the previous context of drug offenses in Thailand, the following explanations can be considered:</p>
<ul>
<li><p><strong>Geographical Factors:</strong> Proximity to borders with neighboring countries, such as Myanmar and Laos, could influence drug trafficking routes and contribute to clustering in those regions.</p></li>
<li><p><strong>Socioeconomic Conditions:</strong> Poverty, unemployment, and lack of educational opportunities might be correlated with higher rates of drug offenses and clustering.</p></li>
<li><p><strong>Governance and Law Enforcement:</strong> The effectiveness of law enforcement agencies and anti-drug initiatives could vary across different regions, impacting the spatial distribution of drug offenses.</p></li>
<li><p><strong>Drug Production and Trafficking:</strong> Understanding the specific types of drugs involved and their production/trafficking routes could provide valuable insights into the spatial patterns.</p></li>
</ul>
<p>Overall, the map provides a valuable visual representation of the spatial distribution of drug offenses in Thailand and the statistical significance of the observed clusters. By carefully examining the hotspots and coldspots, researchers and policymakers can gain insights into the underlying factors driving these patterns and inform targeted interventions to address the drug problem.</p>
</section>
</section>
</section>
<section id="computing-local-gi-statistics" class="level1">
<h1>Computing local Gi* statistics</h1>
<p>need to derive a spatial weight matrix before we can compute local Gi* statistics. Code chunk below will be used to derive a spatial weight matrix by using sfdep functions and tidyverse approach</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#|eval: false</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>wm_thai <span class="ot">&lt;-</span> combined_province_data <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nb=</span><span class="fu">st_contiguity</span>(geometry),</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">wts =</span> <span class="fu">st_inverse_distance</span>(nb,geometry,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">scale=</span><span class="dv">1</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">alpha=</span><span class="dv">1</span>),</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">.before =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! Polygon provided. Using point on surface.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `stopifnot()`.
ℹ In argument: `wts = st_inverse_distance(nb, geometry, scale = 1, alpha = 1)`.
Caused by warning in `st_point_on_surface.sfc()`:
! st_point_on_surface may not give correct results for longitude/latitude data</code></pre>
</div>
</div>
<section id="save-derived-data-2" class="level3">
<h3 class="anchored" data-anchor-id="save-derived-data-2">Save Derived data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(wm_thai,<span class="st">"data/rds/wm_thai.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-derived-data-2" class="level3">
<h3 class="anchored" data-anchor-id="read-derived-data-2">Read Derived data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>wm_thai<span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/wm_thai.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>HCSA <span class="ot">&lt;-</span> wm_thai <span class="sc">%&gt;%</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">local_Gi =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    total_offenses,nb,wt,<span class="at">nsim=</span><span class="dv">99</span>),</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unnest</span>(local_Gi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>HCSA_sig <span class="ot">&lt;-</span> HCSA <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_sim<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(HCSA)<span class="sc">+</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()<span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(HCSA_sig)<span class="sc">+</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"gi_star"</span>)<span class="sc">+</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: One tm layer group has duplicated layer types, which are omitted. To
draw multiple layers of the same type, use multiple layer groups (i.e. specify
tm_shape prior to each of them).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "gi_star" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="take_home_ex2_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key Observations:</strong></p>
<ol type="1">
<li><p><strong>Spatial Clustering:</strong> The map illustrates significant spatial clustering of drug abuse cases, with distinct hotspots and coldspots visible.</p></li>
<li><p><strong>Hotspots:</strong> Provinces in the northern and southern regions appear to have higher Geary’s I values, indicating stronger spatial autocorrelation and potentially higher levels of drug abuse clustered in these areas.</p></li>
<li><p><strong>Coldspots:</strong> Some provinces in the central region seem to have lower Geary’s I values, suggesting weaker spatial autocorrelation and potentially lower levels of drug abuse or more dispersed patterns.</p></li>
</ol>
<p><strong>Potential Explanations and Further Analysis:</strong></p>
<ul>
<li><p><strong>Geographical Factors:</strong> Proximity to borders with neighboring countries, such as Myanmar and Laos, could influence drug trafficking routes and contribute to clustering in those regions.</p></li>
<li><p><strong>Socioeconomic Conditions:</strong> Poverty, unemployment, and lack of educational opportunities might be correlated with higher drug abuse rates and clustering.</p></li>
<li><p><strong>Governance and Law Enforcement:</strong> The effectiveness of law enforcement agencies and anti-drug initiatives could vary across different regions, impacting the spatial distribution of drug abuse.</p></li>
<li><p><strong>Drug Production and Trafficking:</strong> Understanding the specific types of drugs involved and their production/trafficking routes could provide valuable insights into the spatial patterns</p></li>
</ul>
<p>Overall, the map provides a valuable visual representation of the spatial distribution of drug abuse in Thailand and the statistical significance of the observed clusters. By carefully examining the hotspots and coldspots, researchers and policymakers can gain insights into the underlying factors driving these patterns and inform targeted interventions to address the drug problem..</p>
</section>
</section>
<section id="conclusion-and-reflection" class="level1">
<h1>Conclusion and Reflection</h1>
<p>The spatial analysis of drug abuse indicators across Thailand reveals significant regional variations in drug offenses, highlighting the impact of Thailand’s geographical proximity to the Golden Triangle, a notorious drug production area. Provinces near this region exhibit higher rates of drug-related offenses, underscoring their role as both consumption areas and transit hubs for drug trafficking. The use of spatial autocorrelation methods, such as global and local Moran’s I, confirmed clusters of high drug offenses in these provinces. This suggests that drug-related activities are not randomly distributed but are spatially concentrated in specific areas.</p>
<p>The findings further emphasize the vulnerability of certain provinces, particularly those with strong transportation links and infrastructure developments, which facilitate the movement of drugs. The high concentration of drug offenses among youth, especially vocational school students, calls for targeted intervention programs aimed at this demographic.</p>
<section id="reflection" class="level3">
<h3 class="anchored" data-anchor-id="reflection">Reflection</h3>
<p>This assignment underscored the importance of using spatial analysis tools to understand the geographic distribution of social issues like drug abuse. By applying techniques such as spatial autocorrelation, we gained insights into the areas most affected by drug trafficking and consumption in Thailand. The data-driven approach helps inform policy decisions and resource allocation, allowing authorities to focus on high-risk regions and populations.</p>
<p>The exercise also illustrated the complexity of addressing drug abuse in Thailand, as it is influenced by a combination of geopolitical factors, infrastructural developments, and socio-economic conditions. Future studies could explore the relationship between drug offenses and other socio-economic variables, such as income levels, education, and employment, to further refine prevention strategies. Overall, spatial analysis provided a valuable lens through which to examine drug-related issues and supports the development of more effective, geo graphically targeted interventionss</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>